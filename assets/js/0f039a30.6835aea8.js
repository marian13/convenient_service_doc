"use strict";(self.webpackChunkconvenient_service_docs=self.webpackChunkconvenient_service_docs||[]).push([[2605],{5838:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>b,frontMatter:()=>s,metadata:()=>o,toc:()=>d});var r=i(4848),a=i(8453),l=i(6025);const s={slug:"/troubleshooting/i18n_translate_wrong_number_of_arguments",sidebar_position:3,title:"I18n.translate wrong number of arguments"},t=void 0,o={id:"troubleshooting/i18n_translate_wrong_number_of_arguments",title:"I18n.translate wrong number of arguments",description:"This exception may happen when HasJSendResultParamsValidations::UsingActiveModelValidations plugin is used in an environemnt with Ruby 3+ and Rails 5.",source:"@site/docs/troubleshooting/i18n_translate_wrong_number_of_arguments.mdx",sourceDirName:"troubleshooting",slug:"/troubleshooting/i18n_translate_wrong_number_of_arguments",permalink:"/troubleshooting/i18n_translate_wrong_number_of_arguments",draft:!1,unlisted:!1,editUrl:"https://github.com/marian13/convenient_service_docs/blob/main/docs/troubleshooting/i18n_translate_wrong_number_of_arguments.mdx",tags:[],version:"current",sidebarPosition:3,frontMatter:{slug:"/troubleshooting/i18n_translate_wrong_number_of_arguments",sidebar_position:3,title:"I18n.translate wrong number of arguments"},sidebar:"docs",previous:{title:"`AmazingPrintInspect` does not colorize",permalink:"/troubleshooting/amazing_print_inspect_does_not_colorize"},next:{title:"My plugin is added to the config, but its middleware is never called",permalink:"/troubleshooting/added_config_but_middleware_never_called"}},c={},d=[];function u(e){const n={a:"a",code:"code",li:"li",ol:"ol",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Failure/Error: @errors ||= entity.tap(&:valid?).errors.messages.transform_values(&:first)\n\nArgumentError:\n  wrong number of arguments (given 2, expected 0..1)\n# /usr/local/bundle/gems/i18n-1.12.0/lib/i18n.rb:210:in `translate'\n# /usr/local/bundle/gems/activemodel-5.2.8.1/lib/active_model/naming.rb:190:in `human'\n# /usr/local/bundle/gems/activemodel-5.2.8.1/lib/active_model/errors.rb:424:in `generate_message'\n# /usr/local/bundle/gems/activemodel-5.2.8.1/lib/active_model/errors.rb:454:in `normalize_message'\n# /usr/local/bundle/gems/activemodel-5.2.8.1/lib/active_model/errors.rb:298:in `add'\n# /usr/local/bundle/gems/activemodel-5.2.8.1/lib/active_model/validations/presence.rb:7:in `validate_each'\n# /usr/local/bundle/gems/activemodel-5.2.8.1/lib/active_model/validator.rb:152:in `block in validate'\n# /usr/local/bundle/gems/activemodel-5.2.8.1/lib/active_model/validator.rb:149:in `each'\n# /usr/local/bundle/gems/activemodel-5.2.8.1/lib/active_model/validator.rb:149:in `validate'\n# /usr/local/bundle/gems/activesupport-5.2.8.1/lib/active_support/callbacks.rb:426:in `block in make_lambda'\n# /usr/local/bundle/gems/activesupport-5.2.8.1/lib/active_support/callbacks.rb:198:in `block (2 levels) in halting'\n# /usr/local/bundle/gems/activesupport-5.2.8.1/lib/active_support/callbacks.rb:606:in `block (2 levels) in default_termi\nnator'\n# /usr/local/bundle/gems/activesupport-5.2.8.1/lib/active_support/callbacks.rb:605:in `catch'\n# /usr/local/bundle/gems/activesupport-5.2.8.1/lib/active_support/callbacks.rb:605:in `block in default_terminator'\n# /usr/local/bundle/gems/activesupport-5.2.8.1/lib/active_support/callbacks.rb:199:in `block in halting'\n# /usr/local/bundle/gems/activesupport-5.2.8.1/lib/active_support/callbacks.rb:513:in `block in invoke_before'\n# /usr/local/bundle/gems/activesupport-5.2.8.1/lib/active_support/callbacks.rb:513:in `each'\n# /usr/local/bundle/gems/activesupport-5.2.8.1/lib/active_support/callbacks.rb:513:in `invoke_before'\n# /usr/local/bundle/gems/activesupport-5.2.8.1/lib/active_support/callbacks.rb:131:in `run_callbacks'\n# /usr/local/bundle/gems/activesupport-5.2.8.1/lib/active_support/callbacks.rb:816:in `_run_validate_callbacks'\n# /usr/local/bundle/gems/activemodel-5.2.8.1/lib/active_model/validations.rb:409:in `run_validations!'\n# /usr/local/bundle/gems/activemodel-5.2.8.1/lib/active_model/validations.rb:339:in `valid?'\n# ./lib/convenient_service/service/plugins/has_result_params_validations/using_active_model_validations/middleware.rb:28\n:in `errors'\n# ./lib/convenient_service/service/plugins/has_result_params_validations/using_active_model_validations/middleware.rb:10\n:in `next'\n"})}),"\n",(0,r.jsxs)(n.p,{children:["This exception may happen when ",(0,r.jsx)(n.code,{children:"HasJSendResultParamsValidations::UsingActiveModelValidations"})," plugin is used in an environemnt with ",(0,r.jsx)(n.a,{href:"https://www.ruby-lang.org/en/news/2020/12/25/ruby-3-0-0-released/",children:"Ruby 3+"})," and ",(0,r.jsx)(n.a,{href:"https://api.rubyonrails.org/v5.0.0/",children:"Rails 5"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["It is caused by ",(0,r.jsx)(n.a,{href:"https://www.ruby-lang.org/en/news/2019/12/12/separation-of-positional-and-keyword-arguments-in-ruby-3-0/",children:"separation of positional and keyword arguments in Ruby 3.0"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["Check ",(0,r.jsx)(n.a,{href:"https://eregon.me/blog/2021/02/13/correct-delegation-in-ruby-2-27-3.html",children:"correct Delegation with Ruby 2.6, 2.7 and 3.0"})," and ",(0,r.jsx)(n.a,{href:"https://github.com/ruby-i18n/i18n/blob/v1.12.0/lib/i18n.rb#L195",children:"I18n.translate"})," for more details."]}),"\n",(0,r.jsx)("img",{src:(0,l.Ay)("/img/troubleshooting/i18n_translate_wrong_number_of_arguments/i18n_translate.png")}),"\n",(0,r.jsx)(n.p,{children:"Currenty, there is no a simple workaround for it."}),"\n",(0,r.jsx)(n.p,{children:"Actually, you may choose any of the following two options:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://edgeguides.rubyonrails.org/upgrading_ruby_on_rails.html",children:"Upgrade to Rails 6 or higher"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Or remove ",(0,r.jsx)(n.code,{children:"HasJSendResultParamsValidations::UsingActiveModelValidations"})," plugin from config ",(0,r.jsx)("br",{}),"\n(do not forget to remove ",(0,r.jsx)(n.a,{href:"https://edgeguides.rubyonrails.org/active_record_validations.html",children:"validates"})," calls as well)."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ruby",children:"concerns do\n  delete Plugins::Service::HasJSendResultParamsValidations::UsingActiveModelValidations::Concern\nend\n\nmiddlewares :result do\n  delete Plugins::Service::HasJSendResultParamsValidations::UsingActiveModelValidations::Middleware\nend\n"})})]})}function b(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>t});var r=i(6540);const a={},l=r.createContext(a);function s(e){const n=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);